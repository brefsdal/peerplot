<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>PeerPlot</title>
    <link rel="stylesheet" type="text/css" href="static/plot.css">
    <link rel="stylesheet" type="text/css" href="static/jquery-ui.css">
    <script src="static/jquery.min.js" type="text/javascript"></script>
    <script src="static/jquery-ui.min.js" type="text/javascript"></script>
    <script src="static/plot.js" type="text/javascript"></script>
    <script src="static/name.js" type="text/javascript"></script>
    <script src="static/connect.js" type="text/javascript"></script>
    <link rel="shortcut icon" href="{{ static_url("favicon.ico") }}" />
    <link rel="stylesheet" type="text/css" href="{{ static_url("plot.css") }}" >
    <link rel="stylesheet" type="text/css" href="{{ static_url("jquery-ui.css") }}" />
    <script type="text/javascript" src="{{ static_url("jquery.min.js") }}"></script>
    <script type="text/javascript" src="{{ static_url("jquery-ui.min.js") }}"></script>
    <script type="text/javascript" src="{{ static_url("plot.js") }}"></script>
    <script type="text/javascript" src="{{ static_url("name.js") }}"></script>
    <script type="text/javascript" src="{{ static_url("connect.js") }}"></script>
  </head>
  <body id="plotBody">
    <span id="title">
      <h1>PeerPlot Session  {{ session }}</h1>
    </span>
    <div id="clientlist" title="PeerPlot users for session '{{ session }}'"></div>
    <table width="75%" border='0' cellspacing='5px' cellpadding='0'>
      <tr>
        <td class="clienttd" width="33%" valign="top">
          <button id="list-users">Users</button>
        </td>
      </tr>
    </table>
    <div id="info"> </div>
    <span id="plot_canvas" style="position: absolute; top: 120px; left: 10px;">
      <div id="plotDiv" style="width:640px;height:480px;"></div>
      <div id="button_menu" class="buttonmenu">
        <table width="100%" border='0' cellspacing='0' cellpadding='0'>
          <tr width="100%">
            <td width="24" class="cb">
              <img style="cursor: pointer;" id="cb" src="static/nav_cb_s.png"
                   onmouseover='$("#cb").attr("src", "static/nav_cb.png");'
                   onmouseout='$("#cb").attr("src", "static/nav_cb_s.png");' />
            </td>         
            <td id="sm" width="65%" style="cursor: move;">
              <span id="status" style="color: white;">Disconnected</span>
            </td>
            <td id="cm" width="35%" style="cursor: move;">
              <span id="cursor_info" style="color: white;">Cursor</span>
            </td>
            <td>
              <form>
                  <input style="visibility:hidden;" type="checkbox" checked="" id="rotate"></input>
              </form>
            </td>
            <td width="24" class="ro">
              <img id="ro" style="cursor: move;" src="{{ static_url("hand.png") }}" />
            </td>
            <td width="24" class="hb">
              <img style="cursor: pointer;" id="hb" src="static/nav_hb_s.png"
                   onmouseover='$("#hb").attr("src", "static/nav_hb.png");'
                   onmouseout='$("#hb").attr("src", "static/nav_hb_s.png");' />
            </td>
            <td width="24" class="mb">
              <img style="cursor: pointer;" id="mb" src="static/nav_mb_s.png"
                   onmouseover='$("#mb").attr("src", "static/nav_mb.png");'
                   onmouseout='$("#mb").attr("src", "static/nav_mb_s.png");' />
            </td>
            <td id="rbb" width="24" class="rb">
              <img border='0' style="cursor: se-resize;" id="rb" src="static/nav_rb_s.png"
                   onmouseover='$("#rb").attr("src", "static/nav_rb.png");'
                   onmouseout='$("#rb").attr("src", "static/nav_rb_s.png");' />
            </td>
          </tr>
        </table>
      </div>
      <div class="cursor" id="limit_div"></div>
      <div class="zoom" id="zoom_div"></div>
    </span>
    <div id="resize_div" class="resize" ></div>
    <div id="name-dialog" title="Join PeerPlot session {{ session }}">
      <p class="validateTips">Add your name to join.</p>
      <form onsubmit="return false;" >
	<fieldset>
	  <label for="name">Name</label>
	  <input type="text" name="name" id="name" class="text ui-widget-content ui-corner-all" />
	</fieldset>
      </form>
    </div>
<script type="text/javascript">
var plt = null;
var ztop = 0;
$(document).ready(function () {
    var options = {
        host : "{{ server_ip }}",
        port : {{ server_port }},
        session : "{{ session }}",
        height : 480,
        width : 640,
    }
    plt = $.plot($("#plotDiv"), options);
    // TODO: add plt.requestPlot() to the onopen in ConnectionManager
    ConnectionManager.init(options);
    ClientDialog.init({ socket: ConnectionManager.socket });
    $("#list-users")
        .button()
        .click(function() {
            $("#clientlist").dialog("open");
        });
    $("#ro").click(function () {
        if( $("#rotate").is(":checked") ) {
            $(this).attr("src", "{{ static_url("zoom_to_rect.png") }}");
            $("#rotate").attr("checked", false);
        }
        else {
            $(this).attr("src", "{{ static_url("hand.png") }}");
            $("#rotate").attr("checked", true);
        }
    });
});
</script>
  </body> 
</html>
